# 1.论文信息

标题： Trawling for Tor Hidden Services: Detection, Measurement, Deanonymization 

作者： Alex Biryukov, Ivan Pustogarov, Ralf-Philipp Weinmann 

出处： 2013 IEEE Symposium on Security and Privacy 

链接： http://www.ieee-security.org/TC/SP2013/papers/4977a080.pdf 
# 2.研究内容
现有的研究表明，以Tor为代表的匿名通讯系统虽然能在一定程序上能够保护用户的通信安全,但其安全性仍有待商榷，对于如何提高隐藏服务的隐匿性和Tor网络中存在的攻击进行防御等问题有待研究。本文便是针对这些问题，分别就隐藏服务和Tor网络规范中存在的一些漏洞提出了一种能够发现，监测，并破解匿名化隐藏服务的攻击方案，并通过实验验证了该攻击方案的可行性，最后作者也针对自己的攻击方案也提出了相应的防御对策和Tor网络规范的改进建议。

## 2.1 Tor暗网访问流程

本文对于Tor暗网的访问可如下图1所示：

![](https://pic.downk.cc/item/5ea54b81c2a9a83be5da0545.png)

其具体流程可归纳为如下几步：

- 暗网服务启动，生成RSA密钥对，使用RSA公钥的ASN.1的编码版本的SHA-1值的前10个bits作为服务地址，选择3个接入节点，并和每个节点建立连接。
- 暗网服务生成2个不同的描述符，并同时将2个描述符和3个接入节点发送给隐藏服务的目录服务器。
- 用户寻找集合节点，作为连接暗网服务的中间节点。
- 用户将集合节点通过接入节点转发给暗网服务，请求连接。
- 暗网服务建立匿名线路，连接用户的集合节点。

## 2.2 Tor暗网服务攻击方法

本文从Tor暗网访问需要依赖目录服务器入手，根据Tor指纹链算法，提出了一种攻击者抢占目录服务器的方法，其中Tor隐藏服务的指纹链可如图2所示：

![](https://pic.downk.cc/item/5ea55e45c2a9a83be5e97ee6.png)

由于指纹链不是连续的，会有大量的间隔存在，所以攻击者可以通过计算出大量指纹，来将自己所控制的目录服务器插入到指纹链中，若插入的指纹更靠近暗网服务，则暗网服务就会选择攻击者的目录服务器上传其描述符，一旦攻击者借助多个相近的目录服务器完全攻占暗网服务的目录服务器后，所有请求流量便都会经过攻击者所控制的目录服务器，攻击者便可实现对暗网服务的发现和监测，同时再此基础上，攻击者还可借助于流量相关攻击或钓鱼破解暗网服务的匿名性，进而揭露该暗网服务器的所在地址和真实IP，实现匿名网络追踪。

## 2.3 针对Tor暗网服务攻击的防御对策

作者从自己提出的攻击方案出发，共提出了两种防御对策，以使Tor暗网隐藏服务描述符的分发更加安全，其中一种是在目录服务器中隐藏其正在服务的暗网服务器描述符，进而防止了攻击者获取更多洋葱地址；另外一种对策则是重新设计Tor暗网规范，使目录服务器的定位在Tor目录指纹链中无规律可循，攻击者无法预先计算身份密钥，从而切断了其完全攻占暗网服务所对应目录服务器的可能。

# 3.创新点

本文的创新点可主要归纳为如下几点：

- 在Tor暗网访问流程中发现了目录服务器的设计缺陷，并利用Tor服务指纹链中暴露出的问题设计了针对Tor暗网服务的攻击方法。
- 成功实验了作者自己提出的攻击方法，并在很小的代价下轻易实现了对当时主流Silkroad,DuckDuckGo等暗网服务的匿名网络追踪与监测。
- 根据作者自己所发现的漏洞和攻击手段给出了暗网服务的防御对策，并给Tor暗网规范的改进给出了自己的建议。

# 4.评价&目前缺点
本文作为研究Tor暗网服务的匿名网络追踪与监测已十分完善，不仅从原理方面出发阐述了作者发现Tor暗网服务漏洞的过程，详细描述了发现，监测，并破解匿名化暗网服务的攻击方案，亲自实现了该理论方案并成功论证了攻击方案的强有效性；还从攻击的反面给出了Tor暗网服务的防御对策和相关规范的改进方法，总的来说本文是一篇十分优秀且完善的文章。

但唯一遗憾之处在于作者对自己提出的两种防御方案的可行性估计仅停留在理论层面，并未设计相关实验来论证该防御对策的有效性，不过鉴于本文的侧重点应在如何实现对暗网服务的攻击，其在防御方案方面的不完善是可以理解的。